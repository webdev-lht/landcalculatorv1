<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Land Purchase Cost</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-light">

      <!-- Header -->
      <nav class="navbar lime-header bg-dark px-3">
          <div class="container-fluid text-white">
          <a href="00b.dashboard.html" class="btn btn-sm btn-outline-light me-2">‚Üê Back</a>
          <span class="navbar-brand mb-0 h6 text-white">Building Preparation Cost</span>
          </div>
      </nav>

      <!--- Picked Property Details --->
      <div class="mb-3 bg-light border rounded small p-2">
          <div><strong>Address:</strong> <span id="summaryAddress">Loading...</span></div>
          <div><strong>Parcel ID:</strong> <span id="summaryParcelID">Loading...</span></div>
          <div><strong>Coordinates:</strong> <span id="summaryCoords">Loading...</span></div>
      </div>

      <!-- Form Body -->
      <div class="container my-5">
          <p class="text-muted small">
            Estimate the costs involved in preparing the property for vertical construction. This may include demolition, grading, soil testing, temporary utilities, and permits.
          </p>

          <!-- Section 1: Demolition -->
          <div class="mb-4">
            <h6 class="fw-bold">Demolition of Existing Structure</h6>
            <div class="row g-2 align-items-end">
              <div class="col-md-3">
                <label class="form-label">Structure Type</label>
                <select class="form-select">
                  <option selected disabled>Choose...</option>
                  <option>House</option>
                  <option>Barn</option>
                  <option>Shed</option>
                  <option>Other</option>
                </select>
              </div>
              <div class="col-md-2">
                <label class="form-label">Size (sq ft)</label>
                <input type="number" class="form-control" min="0" />
              </div>
              <div class="col-md-2">
                <label class="form-label">Unit Cost ($/sq ft)</label>
                <input type="number" class="form-control" step="0.01" value="7.00"/>
              </div>
              <div class="col-md-2">
                <label class="form-label">Subtotal ($)</label>
                <input type="text" class="form-control" readonly />
              </div>
            </div>
          </div>

          <!-- Section 2: Grading -->
          <div class="mb-4">
            <h6 class="fw-bold">Grading / Land Leveling</h6>
            <div class="row g-2 align-items-end">
              <div class="col-md-3">
                <label class="form-label">Area (acres)</label>
                <input type="number" class="form-control" min="0" />
              </div>
              <div class="col-md-2">
                <label class="form-label">Unit Cost</label>
                <input type="number" class="form-control" step="0.01" value="1.50"/>
              </div>
              <div class="col-md-2">
                <label class="form-label">Subtotal ($)</label>
                <input type="text" class="form-control" readonly />
              </div>
            </div>
          </div>

          <!-- Section 3: Soil Testing -->
          <div class="mb-4">
            <h6 class="fw-bold">Soil Testing / Geotech Report</h6>
            <div class="row g-2 align-items-end">
              <div class="col-md-4">
                <label class="form-label">Report Type</label>
                <select class="form-select">
                  <option selected disabled>Choose...</option>
                  <option>Basic Soil Test</option>
                  <option>Geotech Report</option>
                  <option>Both</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label">Unit Cost ($)</label>
                <input type="number" class="form-control" step="0.01" value="1200"/>
              </div>
              <div class="col-md-3">
                <label class="form-label">Subtotal ($)</label>
                <input type="text" class="form-control" readonly />
              </div>
            </div>
          </div>

          <!-- Section 4: Temporary Utilities -->
          <div class="mb-4">
            <h6 class="fw-bold">Temporary Utilities</h6>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="tempPower" step="0.01" value="850" />
              <label class="form-check-label" for="tempPower">Temporary Power Pole</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="portaPotty" step="0.01" value="150"/>
              <label class="form-check-label" for="portaPotty">Portable Toilet</label>
            </div>
            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="tempWater" step="0.01" value="600"/>
              <label class="form-check-label" for="tempWater">Temporary Water Connection</label>
            </div>
            <div class="row g-2">
              <div class="col-md-3">
                <label class="form-label">Total Cost for Checked Items ($)</label>
                <input type="text" class="form-control" readonly />
              </div>
            </div>
          </div>

          <!-- Section 5: Permits -->
          <div class="mb-4">
            <h6 class="fw-bold">Building Preparation Permits</h6>
            <div class="row g-2 align-items-end">
              <div class="col-md-3">
                <label class="form-label">Estimated Fee ($)</label>
                <input type="number" class="form-control" step="0.01" value="2500" />
              </div>
              <div class="col-md-3">
                <label class="form-label">Subtotal ($)</label>
                <input type="text" class="form-control" readonly />
              </div>
            </div>
          </div>
        </div>

          <hr />
          <div class="mb-3">
              <label class="form-label fw-bold">Total Building Preparation Cost</label>
              <input type="text" id="totalCost" class="form-control readonly-input fw-bold" readonly />
          </div>

          <button id="total_buildCost" class="btn btn-dark" style="max-width: 180px; margin: 20px;" onclick="saveAndContinue()">Save</button>
          </div>

          <!-- Total Section (Inside the scrollable area) -->
              <hr />      

                <div class="d-flex justify-content-between gap-2 mb-3">
                  <a href="./03utilityconnectioncost.html" class="btn btn-outline-secondary w-100">‚¨ÖÔ∏è Previous Step</a>
                  <a href="./05zoningandlegal.html" class="btn btn-outline-secondary w-100">Next Step ‚û°Ô∏è</a>
                </div>

                <div class="d-grid gap-2 mb-5">
                  <a href="00b.dashboard.html" class="btn btn-dark">üè† Back to Cost Dashboard</a>
                  <a href="./09finalstep.html" class="btn btn-outline-dark">‚úÖ Review Your Estimate with LHT</a>
                </div>
                </div> <!-- This closes #formScrollableArea -->
          </div>

        <script>
          function formatUSD(num) {
            return '$' + Number(num).toLocaleString(undefined, { minimumFractionDigits: 2 });
          }

          function calculateBuildingPrepCost() {
            let total = 0;

            // DEMOLITION
            const demoSize = parseFloat(document.querySelectorAll('input[type="number"]')[0].value) || 0;
            const demoUnitCost = parseFloat(document.querySelectorAll('input[type="number"]')[1].value) || 0;
            const demoSubtotal = demoSize * demoUnitCost;
            document.querySelectorAll('input[readonly]')[0].value = formatUSD(demoSubtotal);
            total += demoSubtotal;

            // GRADING
            const gradeArea = parseFloat(document.querySelectorAll('input[type="number"]')[2].value) || 0;
            const gradeUnitCost = parseFloat(document.querySelectorAll('input[type="number"]')[3].value) || 0;
            const gradeSubtotal = gradeArea * gradeUnitCost;
            document.querySelectorAll('input[readonly]')[1].value = formatUSD(gradeSubtotal);
            total += gradeSubtotal;

            // SOIL TESTING
            const soilType = document.querySelectorAll('select')[1].value;
            let soilCost = 0;
            if (soilType === "Basic Soil Test") soilCost = 350;
            else if (soilType === "Geotech Report") soilCost = 1200;
            else if (soilType === "Both") soilCost = 1500;
            document.querySelectorAll('input[readonly]')[2].value = formatUSD(soilCost);
            total += soilCost;

            // TEMPORARY UTILITIES
            let tempUtilCost = 0;
            if (document.getElementById("tempPower").checked) tempUtilCost += parseFloat(document.getElementById("tempPower").value);
            if (document.getElementById("portaPotty").checked) tempUtilCost += parseFloat(document.getElementById("portaPotty").value);
            if (document.getElementById("tempWater").checked) tempUtilCost += parseFloat(document.getElementById("tempWater").value);
            document.querySelectorAll('input[readonly]')[3].value = formatUSD(tempUtilCost);
            total += tempUtilCost;

            // PERMITS
            const permitFee = parseFloat(document.querySelectorAll('input[type="number"]')[4].value) || 0;
            document.querySelectorAll('input[readonly]')[4].value = formatUSD(permitFee);
            total += permitFee;

            // TOTAL
            document.getElementById("totalCost").value = formatUSD(total);
            localStorage.setItem("buildingPrepCost", total.toFixed(2));
          }

          function saveAndContinue() {
            calculateBuildingPrepCost();
            alert("Cost saved.");
          }

          window.onload = () => {
            calculateBuildingPrepCost();

            document.querySelectorAll('input, select').forEach(el => {
              el.addEventListener("input", calculateBuildingPrepCost);
              el.addEventListener("change", calculateBuildingPrepCost);
            });

            // Populate parcel info
            document.getElementById("summaryAddress").textContent = localStorage.getItem("parcelAddress") || "N/A";
            document.getElementById("summaryParcelID").textContent = localStorage.getItem("parcelID") || "N/A";
            document.getElementById("summaryCoords").textContent = `${localStorage.getItem("latitude") || "N/A"}, ${localStorage.getItem("longitude") || "N/A"}`;
          };
      </script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
